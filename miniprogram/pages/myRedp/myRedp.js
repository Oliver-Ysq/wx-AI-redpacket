"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const api_js_1 = require("../../utils/request/api.js");
const request_1 = require("../../utils/request/request");
const util_1 = require("../../utils/util");
const app = getApp();
Page({
    data: {
        active: 0,
        moneySend: 0,
        numberSend: 0,
        moneyReceive: 0,
        numberReceive: 0,
        hasRecInfo: false,
        hasSendInfo: false,
    },
    switchTab(e) {
        const that = this;
        this.setData({
            active: parseInt(e.target.dataset.id),
        });
        if (e.target.dataset.id == 1 && !that.data.hasRecInfo) {
            that.getRecInfo();
        }
        else if (e.target.dataset.id == 0 && !that.data.hasSendInfo) {
            that.getSendInfo();
        }
    },
    change(e) {
        const that = this;
        that.setData({
            active: e.detail.current,
        });
        if (e.detail.current == 1 && !that.data.hasRecInfo) {
            that.getRecInfo();
        }
        else if (e.detail.current == 0 && !that.data.hasSendInfo) {
            that.getSendInfo();
        }
    },
    getRecInfo() {
        const that = this;
        request_1.post(api_js_1.recInfo, {
            sessionid: app.globalData.sessionid,
        })
            .then((res) => {
            console.log(res);
            let data = res.data;
            that.setData({
                numberReceive: data.total_num,
                moneyReceive: util_1.formatMoney(data.total_money),
                receiveList: data.packet_list.map((v) => Object.assign(v, {
                    money: util_1.formatMoney(v.money),
                })),
                hasRecInfo: true,
            });
        })
            .catch((err) => console.log(err));
    },
    getSendInfo() {
        const that = this;
        request_1.post(api_js_1.sendInfo, {
            sessionid: app.globalData.sessionid,
        })
            .then((res) => {
            console.log(res);
            let data = res.data;
            that.setData({
                numberSend: data.total_num,
                moneySend: util_1.formatMoney(data.total_money),
                sendList: data.packet_list.map((v) => Object.assign(v, {
                    total_money: util_1.formatMoney(v.total_money),
                })),
                hasSendInfo: true,
            });
        })
            .catch((err) => console.log(err));
    },
    onLoad: function () {
        const that = this;
        console.log(app.globalData.userInfo.avatarUrl);
        that.setData({
            avatarUrl: app.globalData.userInfo.avatarUrl,
            nickname: app.globalData.userInfo.nickName,
        });
        wx.hideShareMenu({
            menus: ["shareAppMessage", "shareTimeline"],
        });
        that.getSendInfo();
        that.getRecInfo();
    },
    onReady: function () { },
    onShow: function () { },
    onHide: function () { },
    onUnload: function () { },
    onPullDownRefresh: function () { },
    onReachBottom: function () { },
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibXlSZWRwLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsibXlSZWRwLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQ0EsdURBQStEO0FBQy9ELHlEQUFtRDtBQUNuRCwyQ0FBK0M7QUFDL0MsTUFBTSxHQUFHLEdBQUcsTUFBTSxFQUFFLENBQUM7QUFDckIsSUFBSSxDQUFDO0lBQ0QsSUFBSSxFQUFFO1FBQ0YsTUFBTSxFQUFFLENBQUM7UUFFVCxTQUFTLEVBQUUsQ0FBQztRQUNaLFVBQVUsRUFBRSxDQUFDO1FBQ2IsWUFBWSxFQUFFLENBQUM7UUFDZixhQUFhLEVBQUUsQ0FBQztRQUVoQixVQUFVLEVBQUUsS0FBSztRQUNqQixXQUFXLEVBQUUsS0FBSztLQUNyQjtJQUdELFNBQVMsQ0FBQyxDQUFNO1FBQ1osTUFBTSxJQUFJLEdBQUcsSUFBSSxDQUFDO1FBQ2xCLElBQUksQ0FBQyxPQUFPLENBQUM7WUFDVCxNQUFNLEVBQUUsUUFBUSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQztTQUN4QyxDQUFDLENBQUM7UUFDSCxJQUFJLENBQUMsQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLEVBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFVBQVUsRUFBRTtZQUNuRCxJQUFJLENBQUMsVUFBVSxFQUFFLENBQUM7U0FDckI7YUFBTSxJQUFJLENBQUMsQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLEVBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRTtZQUMzRCxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7U0FDdEI7SUFDTCxDQUFDO0lBQ0QsTUFBTSxDQUFDLENBQU07UUFDVCxNQUFNLElBQUksR0FBRyxJQUFJLENBQUM7UUFDbEIsSUFBSSxDQUFDLE9BQU8sQ0FBQztZQUNULE1BQU0sRUFBRSxDQUFDLENBQUMsTUFBTSxDQUFDLE9BQU87U0FD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LENBQUMsUUFBUTtTQUM3QyxDQUFDLENBQUM7UUFDSCxFQUFFLENBQUMsYUFBYSxDQUFDO1lBQ2IsS0FBSyxFQUFFLENBQUMsaUJBQWlCLEVBQUUsZUFBZSxDQUFDO1NBQzlDLENBQUMsQ0FBQztRQUNILElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQztRQUNuQixJQUFJLENBQUMsVUFBVSxFQUFFLENBQUM7SUFDdEIsQ0FBQztJQUVELE9BQU8sRUFBRSxjQUFjLENBQUM7SUFFeEIsTUFBTSxFQUFFLGNBQWMsQ0FBQztJQUV2QixNQUFNLEVBQUUsY0FBYyxDQUFDO0lBRXZCLFFBQVEsRUFBRSxjQUFjLENBQUM7SUFFekIsaUJBQWlCLEVBQUUsY0FBYyxDQUFDO0lBRWxDLGFBQWEsRUFBRSxjQUFjLENBQUM7Q0FDakMsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLy8gcGFnZXMvbXlSZWRwL215UmVkcC5qc1xyXG5pbXBvcnQgeyBzZW5kSW5mbywgcmVjSW5mbyB9IGZyb20gXCIuLi8uLi91dGlscy9yZXF1ZXN0L2FwaS5qc1wiO1xyXG5pbXBvcnQgeyBwb3N0IH0gZnJvbSBcIi4uLy4uL3V0aWxzL3JlcXVlc3QvcmVxdWVzdFwiO1xyXG5pbXBvcnQgeyBmb3JtYXRNb25leSB9IGZyb20gXCIuLi8uLi91dGlscy91dGlsXCI7XHJcbmNvbnN0IGFwcCA9IGdldEFwcCgpO1xyXG5QYWdlKHtcclxuICAgIGRhdGE6IHtcclxuICAgICAgICBhY3RpdmU6IDAsXHJcblxyXG4gICAgICAgIG1vbmV5U2VuZDogMCxcclxuICAgICAgICBudW1iZXJTZW5kOiAwLFxyXG4gICAgICAgIG1vbmV5UmVjZWl2ZTogMCxcclxuICAgICAgICBudW1iZXJSZWNlaXZlOiAwLFxyXG5cclxuICAgICAgICBoYXNSZWNJbmZvOiBmYWxzZSxcclxuICAgICAgICBoYXNTZW5kSW5mbzogZmFsc2UsXHJcbiAgICB9LFxyXG5cclxuICAgIC8vICDliIfmjaLlj5HpgIEgb3Ig5o6l5pS257qi5YyFXHJcbiAgICBzd2l0Y2hUYWIoZTogYW55KSB7XHJcbiAgICAgICAgY29uc3QgdGhhdCA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5zZXREYXRhKHtcclxuICAgICAgICAgICAgYWN0aXZlOiBwYXJzZUludChlLnRhcmdldC5kYXRhc2V0LmlkKSxcclxuICAgICAgICB9KTtcclxuICAgICAgICBpZiAoZS50YXJnZXQuZGF0YXNldC5pZCA9PSAxICYmICF0aGF0LmRhdGEuaGFzUmVjSW5mbykge1xyXG4gICAgICAgICAgICB0aGF0LmdldFJlY0luZm8oKTtcclxuICAgICAgICB9IGVsc2UgaWYgKGUudGFyZ2V0LmRhdGFzZXQuaWQgPT0gMCAmJiAhdGhhdC5kYXRhLmhhc1NlbmRJbmZvKSB7XHJcbiAgICAgICAgICAgIHRoYXQuZ2V0U2VuZEluZm8oKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgY2hhbmdlKGU6IGFueSkge1xyXG4gICAgICAgIGNvbnN0IHRoYXQgPSB0aGlzO1xyXG4gICAgICAgIHRoYXQuc2V0RGF0YSh7XHJcbiAgICAgICAgICAgIGFjdGl2ZTogZS5kZXRhaWwuY3VycmVudCxcclxuICAgICAgICB9KTtcclxuICAgICAgICBpZiAoZS5kZXRhaWwuY3VycmVudCA9PSAxICYmICF0aGF0LmRhdGEuaGFzUmVjSW5mbykge1xyXG4gICAgICAgICAgICB0aGF0LmdldFJlY0luZm8oKTtcclxuICAgICAgICB9IGVsc2UgaWYgKGUuZGV0YWlsLmN1cnJlbnQgPT0gMCAmJiAhdGhhdC5kYXRhLmhhc1NlbmRJbmZvKSB7XHJcbiAgICAgICAgICAgIHRoYXQuZ2V0U2VuZEluZm8oKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIOmAmui/h3JlcXVlc3Tor7fmsYLmjqXmlLbnuqLljIXkv6Hmga9cclxuICAgIGdldFJlY0luZm8oKSB7XHJcbiAgICAgICAgY29uc3QgdGhhdCA9IHRoaXM7XHJcbiAgICAgICAgcG9zdChyZWNJbmZvLCB7XHJcbiAgICAgICAgICAgIHNlc3Npb25pZDogYXBwLmdsb2JhbERhdGEuc2Vzc2lvbmlkLFxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlcyk7XHJcbiAgICAgICAgICAgICAgICBsZXQgZGF0YSA9IHJlcy5kYXRhO1xyXG4gICAgICAgICAgICAgICAgdGhhdC5zZXREYXRhKHtcclxuICAgICAgICAgICAgICAgICAgICBudW1iZXJSZWNlaXZlOiBkYXRhLnRvdGFsX251bSxcclxuICAgICAgICAgICAgICAgICAgICBtb25leVJlY2VpdmU6IGZvcm1hdE1vbmV5KGRhdGEudG90YWxfbW9uZXkpLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlY2VpdmVMaXN0OiBkYXRhLnBhY2tldF9saXN0Lm1hcCgodjogeyBtb25leTogbnVtYmVyIH0pID0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE9iamVjdC5hc3NpZ24odiwge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9uZXk6IGZvcm1hdE1vbmV5KHYubW9uZXkpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICksXHJcbiAgICAgICAgICAgICAgICAgICAgaGFzUmVjSW5mbzogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIOmAmui/h3JlcXVlc3Tor7fmsYLlj5HpgIHnuqLljIXkv6Hmga9cclxuICAgIGdldFNlbmRJbmZvKCkge1xyXG4gICAgICAgIGNvbnN0IHRoYXQgPSB0aGlzO1xyXG4gICAgICAgIHBvc3Qoc2VuZEluZm8sIHtcclxuICAgICAgICAgICAgc2Vzc2lvbmlkOiBhcHAuZ2xvYmFsRGF0YS5zZXNzaW9uaWQsXHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzKVxyXG4gICAgICAgICAgICAgICAgbGV0IGRhdGEgPSByZXMuZGF0YTtcclxuICAgICAgICAgICAgICAgIHRoYXQuc2V0RGF0YSh7XHJcbiAgICAgICAgICAgICAgICAgICAgbnVtYmVyU2VuZDogZGF0YS50b3RhbF9udW0sXHJcbiAgICAgICAgICAgICAgICAgICAgbW9uZXlTZW5kOiBmb3JtYXRNb25leShkYXRhLnRvdGFsX21vbmV5KSxcclxuICAgICAgICAgICAgICAgICAgICBzZW5kTGlzdDogZGF0YS5wYWNrZXRfbGlzdC5tYXAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICh2OiB7IHRvdGFsX21vbmV5OiBudW1iZXIgfSkgPT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9iamVjdC5hc3NpZ24odiwge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsX21vbmV5OiBmb3JtYXRNb25leSh2LnRvdGFsX21vbmV5KSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgKSxcclxuICAgICAgICAgICAgICAgICAgICBoYXNTZW5kSW5mbzogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSk7XHJcbiAgICB9LFxyXG5cclxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGNvbnN0IHRoYXQgPSB0aGlzO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGFwcC5nbG9iYWxEYXRhLnVzZXJJbmZvLmF2YXRhclVybClcclxuICAgICAgICB0aGF0LnNldERhdGEoe1xyXG4gICAgICAgICAgICBhdmF0YXJVcmw6IGFwcC5nbG9iYWxEYXRhLnVzZXJJbmZvLmF2YXRhclVybCxcclxuICAgICAgICAgICAgbmlja25hbWU6IGFwcC5nbG9iYWxEYXRhLnVzZXJJbmZvLm5pY2tOYW1lLFxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHd4LmhpZGVTaGFyZU1lbnUoe1xyXG4gICAgICAgICAgICBtZW51czogW1wic2hhcmVBcHBNZXNzYWdlXCIsIFwic2hhcmVUaW1lbGluZVwiXSxcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGF0LmdldFNlbmRJbmZvKCk7XHJcbiAgICAgICAgdGhhdC5nZXRSZWNJbmZvKCk7XHJcbiAgICB9LFxyXG5cclxuICAgIG9uUmVhZHk6IGZ1bmN0aW9uICgpIHsgfSxcclxuXHJcbiAgICBvblNob3c6IGZ1bmN0aW9uICgpIHsgfSxcclxuXHJcbiAgICBvbkhpZGU6IGZ1bmN0aW9uICgpIHsgfSxcclxuXHJcbiAgICBvblVubG9hZDogZnVuY3Rpb24gKCkgeyB9LFxyXG5cclxuICAgIG9uUHVsbERvd25SZWZyZXNoOiBmdW5jdGlvbiAoKSB7IH0sXHJcblxyXG4gICAgb25SZWFjaEJvdHRvbTogZnVuY3Rpb24gKCkgeyB9LFxyXG59KTtcclxuIl19